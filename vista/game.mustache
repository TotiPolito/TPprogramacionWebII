<html>
<head>
    <title>Game</title>
    <link rel="stylesheet" href="{{BASE_URL}}/public/style/game.css">
    <link rel="stylesheet" href="{{BASE_URL}}/public/style/style.css">
</head>
<body>

<h2 class="categoria {{categoria}}">Categoría: {{categoria}}</h2>
<img src="{{BASE_URL}}/public/{{pregunta.imagen}}" alt="imagen de la pregunta" class="pregunta_imagen">
<p>{{pregunta.descripcion}}</p>

<form id="respuestaForm" action="{{BASE_URL}}/index.php?controller=Game&method=responder" method="POST">
    <input type="hidden" name="idPregunta" value="{{pregunta.id}}">
    <input type="hidden" name="idRespuesta" id="idRespuesta">
</form>

<div class="respuestas">
    {{#respuestas}}
        <button type="button"
                onclick="enviarRespuesta({{id}}, this)"
                data-correcta="{{#estado}}1{{/estado}}{{^estado}}0{{/estado}}">
            {{descripcion}}
        </button>
    {{/respuestas}}
</div>

<script src="{{BASE_URL}}/public/js/dinamicStyle.js"></script>

<script>
    (function(){
        const HOME_URL = "{{BASE_URL}}/index.php?controller=Home&method=Game";
        const SIGUIENTE_URL = "{{BASE_URL}}/index.php?controller=Game&method=jugar";

        //Evita navegar atrás (historial)
        window.history.pushState(null, "", window.location.href);
        window.addEventListener("popstate", function () {
            window.location.replace(HOME_URL);
        });

        //Evita que el navegador use su caché (por seguridad)
        window.addEventListener("pageshow", function (event) {
            if (event.persisted) {
                window.location.replace(HOME_URL);
            }
        });

        //Forzar que "Siguiente pregunta" no deje esta página en el historial
        document.addEventListener("DOMContentLoaded", function () {
            const link = document.querySelector('.link_respuesta[href*="controller=Game&method=jugar"]');
            if (link) {
                link.addEventListener("click", function (e) {
                    e.preventDefault();
                    window.location.replace(SIGUIENTE_URL);
                });
            }
        });
    })();
</script>

</body>
</html>
